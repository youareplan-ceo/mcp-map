name: news_integrated_signal
description: "ë‰´ìŠ¤ ê°ì„± ë¶„ì„ì„ í†µí•©í•œ AI ë§¤ë§¤ ì‹œê·¸ë„"

steps:
  # 1. ì¢…ëª© ë¦¬ìŠ¤íŠ¸ ê°€ì ¸ì˜¤ê¸°
  - tool: data_ingest
    action: list
    args:
      limit: 10

  # 2. ê° ì¢…ëª© ë‰´ìŠ¤ ìˆ˜ì§‘
  - loop: symbols
    tool: news_analyzer
    action: collect_news
    args:
      symbol: "{{ item }}"
      hours: 24

  # 3. ë‰´ìŠ¤ ê°ì„± ë¶„ì„
  - loop: news_articles
    tool: news_analyzer
    action: analyze_sentiment
    args:
      text: "{{ item.title }} {{ item.summary }}"
      symbol: "{{ item.symbol }}"

  # 4. ì „ì²´ ì‹œì¥ ë¶„ìœ„ê¸° íŒŒì•…
  - tool: news_analyzer
    action: get_market_mood
    args:
      symbols: "{{ data_ingest.symbols }}"

  # 5. ê¸°ìˆ ì  ë¶„ì„ (ê¸°ì¡´)
  - loop: symbols
    tool: realtime_processor
    action: process_realtime
    args:
      symbol: "{{ item }}"
      timeframe: "5m"

  # 6. ë‰´ìŠ¤ + ê¸°ìˆ  í†µí•© AI ì ìˆ˜
  - loop: symbols
    agent: profit_maximizer
    task: calculate_combined_score
    args:
      symbol: "{{ item }}"
      technical_score: "{{ realtime_processor.ai_score }}"
      news_sentiment: "{{ news_analyzer.sentiment_score }}"
      formula: "(ê¸°ìˆ ì ìˆ˜ * 0.6) + (ë‰´ìŠ¤ì ìˆ˜ * 0.4)"

  # 7. ìµœì¢… ë§¤ë§¤ ì‹œê·¸ë„ ìƒì„±
  - loop: high_score_symbols
    tool: strategy_selector
    action: apply_strategy
    args:
      symbol: "{{ item.symbol }}"
      strategy: "NEWS_INTEGRATED"
      combined_score: "{{ profit_maximizer.combined_score }}"

  # 8. ê¸´ê¸‰ ë‰´ìŠ¤ ì•Œë¦¼
  - condition: "{{ news_analyzer.alerts.length > 0 }}"
    loop: alerts
    agent: notifier
    task: send_news_alert
    args:
      type: "{{ item.type }}"
      symbol: "{{ item.symbol }}"
      message: |
        ğŸ“° ê¸´ê¸‰ ë‰´ìŠ¤ ì•Œë¦¼
        ì¢…ëª©: {{ item.symbol }}
        íƒ€ì…: {{ item.type }}
        ë‚´ìš©: {{ item.message }}
        
        í˜„ì¬ AI ì ìˆ˜: {{ combined_score }}/100
        ì¶”ì²œ ì•¡ì…˜: {{ strategy_recommendation }}

  # 9. ë°ì´í„°ë² ì´ìŠ¤ ì €ì¥
  - tool: memvector
    action: upsert
    args:
      doc_id: "signal_news_{{ symbol }}_{{ timestamp }}"
      text: |
        [ë‰´ìŠ¤ í†µí•© ì‹œê·¸ë„]
        ì¢…ëª©: {{ symbol }}
        ì‹œê°„: {{ timestamp }}
        ê¸°ìˆ  ì ìˆ˜: {{ technical_score }}
        ë‰´ìŠ¤ ê°ì„±: {{ news_sentiment }}
        í†µí•© AI ì ìˆ˜: {{ combined_score }}
        ì‹œì¥ ë¶„ìœ„ê¸°: {{ market_mood }}
        ë§¤ë§¤ ì‹œê·¸ë„: {{ final_signal }}
        ë‰´ìŠ¤ ìš”ì•½: {{ news_summary }}
