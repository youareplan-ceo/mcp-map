name: realtime_monitoring
description: "ì‹¤ì‹œê°„ ë°ì´í„° ëª¨ë‹ˆí„°ë§ ë° ê¸´ê¸‰ ì•Œë¦¼"

steps:
  # 1. watchlist ì¢…ëª© ì¼ê´„ ì²˜ë¦¬
  - tool: realtime_processor
    action: batch_process
    args:
      symbols: ["AAPL", "NVDA", "TSLA", "005930.KS", "000660.KS"]

  # 2. ê³ ë“ì  ì¢…ëª© ê°œë³„ ë¶„ì„
  - loop: high_score_symbols
    tool: realtime_processor
    action: process_realtime
    args:
      symbol: "{{ item.symbol }}"
      timeframe: "5m"

  # 3. ì´ìƒ íŒ¨í„´ ê°ì§€
  - loop: high_score_symbols
    tool: realtime_processor
    action: detect_anomaly
    args:
      symbol: "{{ item.symbol }}"

  # 4. ìµœì  ì „ëµ ì ìš©
  - loop: high_score_symbols
    tool: strategy_selector
    action: apply_strategy
    args:
      symbol: "{{ item.symbol }}"
      strategy: "RSI_30_70"

  # 5. ìˆ˜ìµ ê·¹ëŒ€í™” ì—”ì§„ (ì•ˆì „ ë¬¸êµ¬ ë³€í™˜)
  - loop: high_score_symbols
    agent: profit_maximizer
    task: convert_score
    args:
      symbol: "{{ item.symbol }}"
      ai_score: "{{ item.score }}"

  # 6. ê¸´ê¸‰ ì•Œë¦¼ (90ì  ì´ìƒ)
  - condition: "{{ item.score >= 90 }}"
    loop: high_score_symbols
    agent: notifier
    task: urgent_alert
    args:
      title: "ğŸš¨ ê¸´ê¸‰ ì‹œê·¸ë„"
      message: |
        ì¢…ëª©: {{ item.symbol }}
        AI ì ìˆ˜: {{ item.score }}/100
        {{ profit_maximizer.safe_message }}
        
        âš ï¸ íˆ¬ì íŒë‹¨ì€ ë³¸ì¸ ì±…ì„ì…ë‹ˆë‹¤.

  # 7. ë°ì´í„°ë² ì´ìŠ¤ ì €ì¥
  - loop: all_processed
    tool: memvector
    action: upsert
    args:
      doc_id: "realtime_{{ item.symbol }}_{{ timestamp }}"
      text: |
        [ì‹¤ì‹œê°„ ëª¨ë‹ˆí„°ë§]
        ì¢…ëª©: {{ item.symbol }}
        ì‹œê°„: {{ timestamp }}
        AI ì ìˆ˜: {{ item.ai_score }}
        ì‹œê·¸ë„: {{ item.signal_strength }}
        RSI: {{ item.rsi }}
        ê±°ë˜ëŸ‰ ë¹„ìœ¨: {{ item.volume_ratio }}
        ì´ìƒ íŒ¨í„´: {{ item.anomaly_type }}
